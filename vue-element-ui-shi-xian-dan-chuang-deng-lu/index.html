<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title> - vue+element-ui 不借助vuex实现弹窗登录</title>

      

      
          <script src="https://cdnjs.cloudflare.com/ajax/libs/slideout/1.0.1/slideout.min.js"></script>
          
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">

          <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
          <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/mathtex-script-type.min.js" integrity="sha384-zWYbd0NBwgTsgIdFKVprSfTh1mbMPe5Hz1X3yY4Sd1h/K1cQoUe36OGwAGz/PcDy" crossorigin="anonymous"></script>
              
          <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"
                  onload="renderMathInElement(document.body);"></script>
              
          
      

      
          <link rel="stylesheet" href="https:&#x2F;&#x2F;www.fewth.com&#x2F;site.css">
          
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
          
      

      
      
    </head>

    <body>
        <div class="container">

            <div id="mobile-navbar" class="mobile-navbar">
              <div class="mobile-header-logo">
                <a href="/" class="logo">Even</a>
              </div>
              <div class="mobile-navbar-icon icon-out">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>

            <nav id="mobile-menu" class="mobile-menu slideout-menu slideout-menu-left">
              <ul class="mobile-menu-list">
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;www.fewth.com">
                            Home
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;www.fewth.com&#x2F;categories">
                            Categories
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;www.fewth.com&#x2F;tags">
                            Tags
                        </a>
                    </li>
                
                    <li class="mobile-menu-item">
                        <a href="https:&#x2F;&#x2F;www.fewth.com&#x2F;about">
                            About
                        </a>
                    </li>
                
              </ul>
            </nav>

            <header id="header">
                <div class="logo"><a href="https:&#x2F;&#x2F;www.fewth.com">Even</a></div>
                <nav class="menu">
                    <ul>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;www.fewth.com">
                                    Home
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;www.fewth.com&#x2F;categories">
                                    Categories
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;www.fewth.com&#x2F;tags">
                                    Tags
                                </a>
                            </li>
                        
                            <li>
                                <a href="https:&#x2F;&#x2F;www.fewth.com&#x2F;about">
                                    About
                                </a>
                            </li>
                        
                    </ul>
                </nav>
            </header>

            <main>
                <div class="content" id="mobile-panel">
                    


<div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content always-active">
        <nav id="TableOfContents">
            <ul>
                
                <li>
                    <a href="https://www.fewth.com/vue-element-ui-shi-xian-dan-chuang-deng-lu/#zhu-yao-si-lu" class="toc-link">主要思路</a>
                    
                </li>
                
                <li>
                    <a href="https://www.fewth.com/vue-element-ui-shi-xian-dan-chuang-deng-lu/#dai-ma-shi-yi" class="toc-link">代码示意</a>
                    
                    <ul>
                        
                        <li>
                            <a href="https://www.fewth.com/vue-element-ui-shi-xian-dan-chuang-deng-lu/#fu-zu-jian" class="toc-link">父组件</a>
                        </li>
                        
                        <li>
                            <a href="https://www.fewth.com/vue-element-ui-shi-xian-dan-chuang-deng-lu/#zi-zu-jian" class="toc-link">子组件</a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                <li>
                    <a href="https://www.fewth.com/vue-element-ui-shi-xian-dan-chuang-deng-lu/#qi-ta" class="toc-link">其它</a>
                    
                </li>
                
            </ul>
        </nav>
    </div>
</div>


<article class="post">
    
    <header class="post__header">
        <h1 class="post__title">
            <a href="https:&#x2F;&#x2F;www.fewth.com&#x2F;vue-element-ui-shi-xian-dan-chuang-deng-lu&#x2F;">vue+element-ui 不借助vuex实现弹窗登录</a>
        </h1>
        <div class="post__meta">
            <span class="post__time">2020-09-01</span>
            
        </div>
    </header>

    <div class="post-content">
      <blockquote>
<p>本文主要介绍不使用vuex的情况下，通过父子组件传值通信等方法达到弹窗登录的目的。在生产环境中，使用vuex会非常的方便，通过store去维护一个&quot;isLoginVisible&quot;变量即可。</p>
</blockquote>
<h2 id="zhu-yao-si-lu">主要思路</h2>
<p>首先，在同一个页面文件中实现弹窗功能一般没什么问题，定义一个状态变量控制组件的显示就行了。这里主要介绍弹窗作为一个单独的单文件组件时的情况，涉及父子组件通信及属性绑定的问题。</p>
<p>实现：</p>
<!--more-->
<ul>
<li>弹窗子组件采用<code>element-ui</code>的<code>&lt;el-dialog&gt;</code>元素，该元素有一个<code>visible</code>属性,定义一个<code>isShow</code>的状态prop来控制该弹窗是否显示。</li>
<li>子组件中不直接修改这个<code>isShow</code>的prop，而是通过<code>this.$emit('update:isShow',false)</code>这样的方式，用事件通知父组件自己想要修改<code>isShow</code>的值</li>
<li>父组件里面定义一个<code>showDialogOrNot</code>之类的<code>data</code>字段来维护弹窗是否显示,父组件中修改弹窗状态时，直接修改<code>showDialogOrNot</code>的值即可。</li>
<li>父组件在引用子组件时，对<code>isShow</code>属性作双向绑定：<code>&lt;child-component :is-show.sync=&quot;showDialogOrNot&quot;&gt;&lt;/child-component&gt;</code>。</li>
</ul>
<h2 id="dai-ma-shi-yi">代码示意</h2>
<h3 id="fu-zu-jian">父组件</h3>
<pre style="background-color:#2b303b;">
<code class="language-js" data-lang="js"><span style="color:#65737e;">//Parent.vue
</span><span style="color:#c0c5ce;">&lt;template&gt;
  &lt;div&gt;
      &lt;el-button round id=&quot;</span><span style="color:#a3be8c;">sign-in</span><span style="color:#c0c5ce;">&quot; @click=&quot;</span><span style="color:#a3be8c;">openLogin</span><span style="color:#c0c5ce;">&quot;&gt;</span><span style="color:#bf616a;">登录</span><span style="color:#c0c5ce;">&lt;/</span><span style="color:#bf616a;">el</span><span style="color:#c0c5ce;">-</span><span style="color:#bf616a;">button</span><span style="color:#c0c5ce;">&gt;
      &lt;Login :is-show.sync=&quot;</span><span style="color:#a3be8c;">isLoginVisible</span><span style="color:#c0c5ce;">&quot;&gt;&lt;/Login&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
</span><span style="color:#b48ead;">import </span><span style="color:#bf616a;">Login </span><span style="color:#b48ead;">from </span><span style="color:#c0c5ce;">&quot;</span><span style="color:#a3be8c;">@/components/Login</span><span style="color:#c0c5ce;">&quot;;
</span><span style="color:#b48ead;">export default </span><span style="color:#c0c5ce;">{
  name: &quot;</span><span style="color:#a3be8c;">Header</span><span style="color:#c0c5ce;">&quot;,
  components: {</span><span style="color:#bf616a;">Login</span><span style="color:#c0c5ce;">},
  props:[],
  </span><span style="color:#8fa1b3;">data</span><span style="color:#c0c5ce;">(){
    </span><span style="color:#b48ead;">return</span><span style="color:#c0c5ce;">{
      isLoginVisible:</span><span style="color:#d08770;">false</span><span style="color:#c0c5ce;">,
    }
  },
  methods:{
    </span><span style="color:#8fa1b3;">openLogin</span><span style="color:#c0c5ce;">(){
      </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">isLoginVisible</span><span style="color:#c0c5ce;">=</span><span style="color:#d08770;">true</span><span style="color:#c0c5ce;">;
    },
  }
}
&lt;/</span><span style="color:#bf616a;">script</span><span style="color:#c0c5ce;">&gt;

&lt;style scoped&gt;
#</span><span style="color:#bf616a;">name </span><span style="color:#c0c5ce;">{
  </span><span style="color:#bf616a;">font</span><span style="color:#c0c5ce;">-size: 30</span><span style="color:#bf616a;">px</span><span style="color:#c0c5ce;">;
  </span><span style="color:#bf616a;">font</span><span style="color:#c0c5ce;">-weight: </span><span style="color:#bf616a;">bold</span><span style="color:#c0c5ce;">;
}
#</span><span style="color:#bf616a;">register</span><span style="color:#c0c5ce;">{
  padding: 5</span><span style="color:#bf616a;">px</span><span style="color:#c0c5ce;">;
}
#</span><span style="color:#bf616a;">register</span><span style="color:#c0c5ce;">{
  padding: 5</span><span style="color:#bf616a;">px</span><span style="color:#c0c5ce;">;
}
&lt;/</span><span style="color:#bf616a;">style</span><span style="color:#c0c5ce;">&gt;
</span></code></pre><h3 id="zi-zu-jian">子组件</h3>
<p>一个不好的例子：</p>
<h4 id="zi-zu-jian-dan-chuang-zu-jian-you-que-xian-de-ban-ben">子组件（弹窗组件)---<strong>有缺陷的版本</strong></h4>
<pre style="background-color:#2b303b;">
<code class="language-js" data-lang="js"><span style="color:#65737e;">//Login.vue
</span><span style="color:#c0c5ce;">&lt;template&gt;
  &lt;div&gt;
    &lt;el-dialog v-bind=&quot;</span><span style="color:#a3be8c;">$attrs</span><span style="color:#c0c5ce;">&quot;
               v-on=&quot;</span><span style="color:#a3be8c;">$listeners</span><span style="color:#c0c5ce;">&quot;
               @open=&quot;</span><span style="color:#a3be8c;">onOpen</span><span style="color:#c0c5ce;">&quot;
               @close=&quot;</span><span style="color:#a3be8c;">onClose</span><span style="color:#c0c5ce;">&quot;
               title=&quot;</span><span style="color:#a3be8c;">登录</span><span style="color:#c0c5ce;">&quot;
               :visible=&quot;</span><span style="color:#a3be8c;">isShow</span><span style="color:#c0c5ce;">&quot;
               :close-on-click-modal=&quot;</span><span style="color:#a3be8c;">false</span><span style="color:#c0c5ce;">&quot;
               :show-close=&quot;</span><span style="color:#a3be8c;">false</span><span style="color:#c0c5ce;">&quot;&gt;
      &lt;el-form ref=&quot;</span><span style="color:#a3be8c;">elForm</span><span style="color:#c0c5ce;">&quot; :model=&quot;</span><span style="color:#a3be8c;">formData</span><span style="color:#c0c5ce;">&quot; :rules=&quot;</span><span style="color:#a3be8c;">rules</span><span style="color:#c0c5ce;">&quot; size=&quot;</span><span style="color:#a3be8c;">medium</span><span style="color:#c0c5ce;">&quot; label-width=&quot;</span><span style="color:#a3be8c;">100px</span><span style="color:#c0c5ce;">&quot;&gt;
        &lt;el-form-item label=&quot;</span><span style="color:#a3be8c;">用户名</span><span style="color:#c0c5ce;">&quot; prop=&quot;</span><span style="color:#a3be8c;">username</span><span style="color:#c0c5ce;">&quot;&gt;
          &lt;el-input v-model=&quot;</span><span style="color:#a3be8c;">formData.username</span><span style="color:#c0c5ce;">&quot;
                    show-word-limit clearable prefix-icon=&#39;</span><span style="color:#a3be8c;">el-icon-user-solid</span><span style="color:#c0c5ce;">&#39; :style=&quot;</span><span style="color:#a3be8c;">{width: &#39;100%&#39;}</span><span style="color:#c0c5ce;">&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
        &lt;el-form-item label=&quot;</span><span style="color:#a3be8c;">密码</span><span style="color:#c0c5ce;">&quot; prop=&quot;</span><span style="color:#a3be8c;">password</span><span style="color:#c0c5ce;">&quot;&gt;
          &lt;el-input v-model=&quot;</span><span style="color:#a3be8c;">formData.password</span><span style="color:#c0c5ce;">&quot; placeholder=&quot;</span><span style="color:#a3be8c;">请输入密码</span><span style="color:#c0c5ce;">&quot; clearable show-password
                    :style=&quot;</span><span style="color:#a3be8c;">{width: &#39;100%&#39;}</span><span style="color:#c0c5ce;">&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
      &lt;/el-form&gt;
      &lt;div slot=&quot;</span><span style="color:#a3be8c;">footer</span><span style="color:#c0c5ce;">&quot;&gt;
            &lt;el-button @click=&quot;</span><span style="color:#a3be8c;">close</span><span style="color:#c0c5ce;">&quot;&gt;</span><span style="color:#bf616a;">取消</span><span style="color:#c0c5ce;">&lt;/</span><span style="color:#bf616a;">el</span><span style="color:#c0c5ce;">-</span><span style="color:#bf616a;">button</span><span style="color:#c0c5ce;">&gt;
            &lt;el-button type=&quot;</span><span style="color:#a3be8c;">primary</span><span style="color:#c0c5ce;">&quot; @click=&quot;</span><span style="color:#a3be8c;">handleConfirm</span><span style="color:#c0c5ce;">&quot;&gt;</span><span style="color:#bf616a;">确定</span><span style="color:#c0c5ce;">&lt;/</span><span style="color:#bf616a;">el</span><span style="color:#c0c5ce;">-</span><span style="color:#bf616a;">button</span><span style="color:#c0c5ce;">&gt;
      &lt;/div&gt;
    &lt;/el-dialog&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
</span><span style="color:#b48ead;">export default </span><span style="color:#c0c5ce;">{
  inheritAttrs: </span><span style="color:#d08770;">false</span><span style="color:#c0c5ce;">,
  components: {},
  props: {
    isShow:</span><span style="color:#ebcb8b;">Boolean
  </span><span style="color:#c0c5ce;">},
  </span><span style="color:#8fa1b3;">data</span><span style="color:#c0c5ce;">() {
    </span><span style="color:#b48ead;">return </span><span style="color:#c0c5ce;">{
      formData: {
        username: </span><span style="color:#d08770;">undefined</span><span style="color:#c0c5ce;">,
        password: &quot;&quot;,
      },
    }
  },
  methods: {
    </span><span style="color:#8fa1b3;">onClose</span><span style="color:#c0c5ce;">() {
      </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">$refs</span><span style="color:#c0c5ce;">[&#39;</span><span style="color:#a3be8c;">elForm</span><span style="color:#c0c5ce;">&#39;].</span><span style="color:#8fa1b3;">resetFields</span><span style="color:#c0c5ce;">();
    },
    </span><span style="color:#8fa1b3;">close</span><span style="color:#c0c5ce;">() {
      </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">$emit</span><span style="color:#c0c5ce;">(&#39;</span><span style="color:#a3be8c;">update:isShow</span><span style="color:#c0c5ce;">&#39;, </span><span style="color:#d08770;">false</span><span style="color:#c0c5ce;">);
    },
    </span><span style="color:#8fa1b3;">handleConfirm</span><span style="color:#c0c5ce;">() {
      </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">$refs</span><span style="color:#c0c5ce;">[&#39;</span><span style="color:#a3be8c;">elForm</span><span style="color:#c0c5ce;">&#39;].</span><span style="color:#8fa1b3;">validate</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">valid </span><span style="color:#b48ead;">=&gt; </span><span style="color:#c0c5ce;">{
        </span><span style="color:#b48ead;">if </span><span style="color:#c0c5ce;">(!</span><span style="color:#bf616a;">valid</span><span style="color:#c0c5ce;">) </span><span style="color:#b48ead;">return
        </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#96b5b4;">close</span><span style="color:#c0c5ce;">()
      })
    },
  }
}

&lt;/</span><span style="color:#bf616a;">script</span><span style="color:#c0c5ce;">&gt;
&lt;style&gt;
&lt;/style&gt;
</span></code></pre>
<p>刚开始的时候，直接用一个子组件中的<code>prop</code>来通信，这样可以实现如下的功能：在父组件中点击登录时，弹窗出现，在弹窗中点击取消时，弹窗消失，好像也没什么问题。</p>
<p>但是，如果把上面的<code>:show-close</code>改成<code>true</code>，也就是显示弹窗右上角的关闭按钮，会发现点击这个按钮是无效的。通过查看<code>&lt;el-dialog&gt;</code>的实现代码，发现点击这个按钮的时候是触发一个<code>handleClose</code>方法，这个方法的相关实现如下：</p>
<pre style="background-color:#2b303b;">
<code class="language-js" data-lang="js"><span style="color:#8fa1b3;">handleClose</span><span style="color:#c0c5ce;">() {
    </span><span style="color:#b48ead;">if </span><span style="color:#c0c5ce;">(typeof </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">beforeClose </span><span style="color:#c0c5ce;">=== &#39;</span><span style="color:#a3be8c;">function</span><span style="color:#c0c5ce;">&#39;) {
        </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">beforeClose</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">hide</span><span style="color:#c0c5ce;">);
    } </span><span style="color:#b48ead;">else </span><span style="color:#c0c5ce;">{
        </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">hide</span><span style="color:#c0c5ce;">();
    }
}
</span><span style="color:#8fa1b3;">hide</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">cancel</span><span style="color:#c0c5ce;">) {
    </span><span style="color:#b48ead;">if </span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">cancel </span><span style="color:#c0c5ce;">!== </span><span style="color:#d08770;">false</span><span style="color:#c0c5ce;">) {
        </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">$emit</span><span style="color:#c0c5ce;">(&#39;</span><span style="color:#a3be8c;">update:visible</span><span style="color:#c0c5ce;">&#39;, </span><span style="color:#d08770;">false</span><span style="color:#c0c5ce;">);
        </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">$emit</span><span style="color:#c0c5ce;">(&#39;</span><span style="color:#a3be8c;">close</span><span style="color:#c0c5ce;">&#39;);
        </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.closed = </span><span style="color:#d08770;">true</span><span style="color:#c0c5ce;">;
    }
}
</span></code></pre>
<p>可以看到：</p>
<p>如果没有定义<code>beforeClose</code>的话，<code>handleClose</code>会直接调用<code>hide()</code>方法，而<code>hide</code>中会触发一个事件，试图更新<code>visible</code>的值，但是之前的代码并没有给<code>visible</code>设置<code>.sync</code>，也就是没有双向绑定，导致<code>visible</code>的值只能由父组件来设置，子组件传递的这个事件并不会被父组件接收，而<code>&lt;el-dialog&gt;</code>就是通过<code>visible</code>的值来控制组件是否显示的。如果给<code>visible</code>加上<code>.sync</code>，会出现另一个问题，<code>Avoid mutating a prop directly...</code>，尝试在本地修改<code>props</code>的值，这是官方不建议的，会导致逻辑混乱。</p>
<p>关于<code>visible</code>的变化情况大致如下：</p>
<ol>
<li>在父组件中点击<code>登录</code>时，触发<code>openLogin</code>方法，通过<code>isLoginVisible</code>来设置<code>isShow</code>为<code>true</code>，而<code>isShow</code>将值传给<code>visible</code>，此时<code>visilbe</code>为<code>true</code>。</li>
<li>点击关闭按钮，子组件(el-dialog)传递事件给父组件(login)，尝试修改<code>isVisible</code>的值为false,但是父组件未处理该事件，因为<code>:isVisible</code>没有用<code>.sync</code>实现双向绑定，此时<code>visible</code>仍然为<code>true</code>，也就是点击关闭按钮没有反应。</li>
</ol>
<p>这个问题可以通过在子组件中增加一个变量来解决。</p>
<hr />
<h4 id="zi-zu-jian-dan-chuang-zu-jian-xiu-gai-hou-de-ban-ben">子组件（弹窗组件)---<strong>修改后的版本</strong></h4>
<pre style="background-color:#2b303b;">
<code class="language-js" data-lang="js"><span style="color:#65737e;">//Login.vue
</span><span style="color:#c0c5ce;">&lt;template&gt;
  &lt;div&gt;
    &lt;el-dialog v-bind=&quot;</span><span style="color:#a3be8c;">$attrs</span><span style="color:#c0c5ce;">&quot;
               v-on=&quot;</span><span style="color:#a3be8c;">$listeners</span><span style="color:#c0c5ce;">&quot;
               @open=&quot;</span><span style="color:#a3be8c;">onOpen</span><span style="color:#c0c5ce;">&quot;
               @close=&quot;</span><span style="color:#a3be8c;">onClose</span><span style="color:#c0c5ce;">&quot;
               title=&quot;</span><span style="color:#a3be8c;">登录</span><span style="color:#c0c5ce;">&quot;
               :visible.sync=&quot;</span><span style="color:#a3be8c;">isVisible</span><span style="color:#c0c5ce;">&quot;
               :close-on-click-modal=&quot;</span><span style="color:#a3be8c;">false</span><span style="color:#c0c5ce;">&quot;
               :show-close=&quot;</span><span style="color:#a3be8c;">true</span><span style="color:#c0c5ce;">&quot;&gt;
      &lt;el-form ref=&quot;</span><span style="color:#a3be8c;">elForm</span><span style="color:#c0c5ce;">&quot; :model=&quot;</span><span style="color:#a3be8c;">formData</span><span style="color:#c0c5ce;">&quot; :rules=&quot;</span><span style="color:#a3be8c;">rules</span><span style="color:#c0c5ce;">&quot; size=&quot;</span><span style="color:#a3be8c;">medium</span><span style="color:#c0c5ce;">&quot; label-width=&quot;</span><span style="color:#a3be8c;">100px</span><span style="color:#c0c5ce;">&quot;&gt;
        &lt;el-form-item label=&quot;</span><span style="color:#a3be8c;">用户名</span><span style="color:#c0c5ce;">&quot; prop=&quot;</span><span style="color:#a3be8c;">username</span><span style="color:#c0c5ce;">&quot;&gt;
          &lt;el-input v-model=&quot;</span><span style="color:#a3be8c;">formData.username</span><span style="color:#c0c5ce;">&quot;
                    show-word-limit clearable prefix-icon=&#39;</span><span style="color:#a3be8c;">el-icon-user-solid</span><span style="color:#c0c5ce;">&#39; :style=&quot;</span><span style="color:#a3be8c;">{width: &#39;100%&#39;}</span><span style="color:#c0c5ce;">&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
        &lt;el-form-item label=&quot;</span><span style="color:#a3be8c;">密码</span><span style="color:#c0c5ce;">&quot; prop=&quot;</span><span style="color:#a3be8c;">password</span><span style="color:#c0c5ce;">&quot;&gt;
          &lt;el-input v-model=&quot;</span><span style="color:#a3be8c;">formData.password</span><span style="color:#c0c5ce;">&quot; placeholder=&quot;</span><span style="color:#a3be8c;">请输入密码</span><span style="color:#c0c5ce;">&quot; clearable show-password
                    :style=&quot;</span><span style="color:#a3be8c;">{width: &#39;100%&#39;}</span><span style="color:#c0c5ce;">&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
      &lt;/el-form&gt;
      &lt;div slot=&quot;</span><span style="color:#a3be8c;">footer</span><span style="color:#c0c5ce;">&quot;&gt;
            &lt;el-button @click=&quot;</span><span style="color:#a3be8c;">close</span><span style="color:#c0c5ce;">&quot;&gt;</span><span style="color:#bf616a;">取消</span><span style="color:#c0c5ce;">&lt;/</span><span style="color:#bf616a;">el</span><span style="color:#c0c5ce;">-</span><span style="color:#bf616a;">button</span><span style="color:#c0c5ce;">&gt;
            &lt;el-button type=&quot;</span><span style="color:#a3be8c;">primary</span><span style="color:#c0c5ce;">&quot; @click=&quot;</span><span style="color:#a3be8c;">handleConfirm</span><span style="color:#c0c5ce;">&quot;&gt;</span><span style="color:#bf616a;">确定</span><span style="color:#c0c5ce;">&lt;/</span><span style="color:#bf616a;">el</span><span style="color:#c0c5ce;">-</span><span style="color:#bf616a;">button</span><span style="color:#c0c5ce;">&gt;
      &lt;/div&gt;
    &lt;/el-dialog&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
</span><span style="color:#b48ead;">export default </span><span style="color:#c0c5ce;">{
  inheritAttrs: </span><span style="color:#d08770;">false</span><span style="color:#c0c5ce;">,
  components: {},
  props: {
    isShow:</span><span style="color:#ebcb8b;">Boolean
  </span><span style="color:#c0c5ce;">},
  </span><span style="color:#8fa1b3;">data</span><span style="color:#c0c5ce;">() {
    </span><span style="color:#b48ead;">return </span><span style="color:#c0c5ce;">{
      formData: {
        username: </span><span style="color:#d08770;">undefined</span><span style="color:#c0c5ce;">,
        password: &quot;&quot;,
      },
      isVisible:</span><span style="color:#d08770;">false</span><span style="color:#c0c5ce;">,
    }
  },
  watch:{
    </span><span style="color:#8fa1b3;">isVisible</span><span style="color:#c0c5ce;">:</span><span style="color:#b48ead;">function </span><span style="color:#c0c5ce;">(){
      </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">$emit</span><span style="color:#c0c5ce;">(&#39;</span><span style="color:#a3be8c;">update:isShow</span><span style="color:#c0c5ce;">&#39;,</span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">isVisible</span><span style="color:#c0c5ce;">)
    },
    </span><span style="color:#8fa1b3;">isShow</span><span style="color:#c0c5ce;">:</span><span style="color:#b48ead;">function </span><span style="color:#c0c5ce;">(){
      </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">isVisible</span><span style="color:#c0c5ce;">=</span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">isShow</span><span style="color:#c0c5ce;">;
    }
  },
  methods: {
    </span><span style="color:#8fa1b3;">onOpen</span><span style="color:#c0c5ce;">() {
    },
    </span><span style="color:#8fa1b3;">onClose</span><span style="color:#c0c5ce;">() {
      </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">$refs</span><span style="color:#c0c5ce;">[&#39;</span><span style="color:#a3be8c;">elForm</span><span style="color:#c0c5ce;">&#39;].</span><span style="color:#8fa1b3;">resetFields</span><span style="color:#c0c5ce;">();
    },
    </span><span style="color:#8fa1b3;">close</span><span style="color:#c0c5ce;">() {
      </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#8fa1b3;">$emit</span><span style="color:#c0c5ce;">(&#39;</span><span style="color:#a3be8c;">update:isShow</span><span style="color:#c0c5ce;">&#39;,</span><span style="color:#d08770;">false</span><span style="color:#c0c5ce;">);
    },
    </span><span style="color:#8fa1b3;">handleConfirm</span><span style="color:#c0c5ce;">() {
      </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#bf616a;">$refs</span><span style="color:#c0c5ce;">[&#39;</span><span style="color:#a3be8c;">elForm</span><span style="color:#c0c5ce;">&#39;].</span><span style="color:#8fa1b3;">validate</span><span style="color:#c0c5ce;">(</span><span style="color:#bf616a;">valid </span><span style="color:#b48ead;">=&gt; </span><span style="color:#c0c5ce;">{
        </span><span style="color:#b48ead;">if </span><span style="color:#c0c5ce;">(!</span><span style="color:#bf616a;">valid</span><span style="color:#c0c5ce;">) </span><span style="color:#b48ead;">return
        </span><span style="color:#bf616a;">this</span><span style="color:#c0c5ce;">.</span><span style="color:#96b5b4;">close</span><span style="color:#c0c5ce;">()
      })
    },
  }
}

&lt;/</span><span style="color:#bf616a;">script</span><span style="color:#c0c5ce;">&gt;
&lt;style&gt;
&lt;/style&gt;
</span></code></pre>
<ul>
<li>修改后的子组件代码比之前多了一个<code>isVisible</code>变量，把设置<code>:visible.sync=isVisible</code>，<strong>避免</strong>了子组件中直接修改<code>props</code>的情况。</li>
<li>同时在<code>watch</code>中增加了对<code>isShow</code>和<code>isVisible</code>的监控：
<ul>
<li>如果<code>isShow</code>变化了，说明是父组件传过来的，则在子组件中把新值赋给<code>isVisible</code>，进而修改<code>visible</code>的值，控制组件显示。</li>
<li>如果<code>isVisible</code>变化了，说明是子组件中自己发生状态变化（如上面的&quot;点击右上角的关闭按钮&quot;这个事件）,则通过传递一个事件给父组件，通知父组件自己想要修改<code>isShow</code>的值，目标值就是变化后的<code>isVisible</code>，父组件收到事件后，通过修改子组件的<code>isShow</code>属性来控制显示。</li>
</ul>
</li>
</ul>
<h2 id="qi-ta">其它</h2>
<p>vue中的props，如果要定义类型啥的，则使用的是对象形式，用<code>{}</code>包裹,且属性名不用引号也可以，如果只是列出属性不加约束，则使用字符串数组的模式，此时用<code>[]</code>包裹，且属性名必须加引号。</p>

    </div>

    
    

    <div class="post-footer">
        
            
            
                <div class="post-nav">
                    
                        <a class="previous" href="https:&#x2F;&#x2F;www.fewth.com&#x2F;vuezhong-de-da-xiao-xie&#x2F;">‹ Vue中的大小写</a>
                    
                    
                        <a class="next" href="https:&#x2F;&#x2F;www.fewth.com&#x2F;aesqian-duan-mi-ma-jia-mi-hou-duan-java-jie-mi-de-yi-xie-ji-lu&#x2F;">AES前端密码加密后端(java)解密的一些记录 ›</a>
                    
                    
                    
                </div>
            

        

    </div>

    
    
</article>


                </div>
            </main>

            
            
        </div>

      
          <script type="text/javascript" src="https:&#x2F;&#x2F;www.fewth.com&#x2F;even.js" ></script>
      
    </body>

</html>
